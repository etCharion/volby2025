<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analýza Školních Voleb 2025</title>
    <!-- Tailwind CSS CDN pro rychlý a responzivní design -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Nastavení písma Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
    </style>
    <!-- React, ReactDOM, Babel, a Recharts CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.min.js"></script>
</head>
<body>
    <div id="root" class="p-4 md:p-8"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;
        const { PieChart, Pie, Cell, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

        // --- DATA Z CSV SOUBORU ---
        const initialData = [
            { name: 'Spolu', p13: 26, p4: 3, student: 29, teacher: 4, total: 33 },
            { name: 'SPD', p13: 1, p4: 0, student: 1, teacher: 0, total: 1 },
            { name: 'Motoristé', p13: 5, p4: 2, student: 7, teacher: 1, total: 8 },
            { name: 'MZH', p13: 1, p4: 0, student: 1, teacher: 0, total: 1 },
            { name: 'Generace', p13: 1, p4: 0, student: 1, teacher: 0, total: 1 },
            { name: 'Levice', p13: 1, p4: 0, student: 1, teacher: 0, total: 1 },
            { name: 'SMS', p13: 1, p4: 1, student: 2, teacher: 0, total: 2 },
            { name: 'Přísaha', p13: 1, p4: 0, student: 1, teacher: 0, total: 1 },
            { name: 'Voluntia', p13: 3, p4: 0, student: 3, teacher: 0, total: 3 },
            { name: 'Ano', p13: 2, p4: 0, student: 2, teacher: 0, total: 2 },
            { name: 'Rebelové', p13: 3, p4: 0, student: 3, teacher: 0, total: 3 },
            { name: 'Koruna', p13: 1, p4: 0, student: 1, teacher: 1, total: 2 },
            { name: 'STAN', p13: 35, p4: 9, student: 44, teacher: 4, total: 48 },
            { name: 'Piráti', p13: 24, p4: 3, student: 27, teacher: 1, total: 28 },
        ];
        
        // Data z CSV řádků "Odevzdané hlasy" a "Maximální počet hlasujících"
        const totalElectorate = { student: 182, teacher: 24, total: 206 };
        const votesCast = { student: 123, teacher: 11, total: 134 };
        // Počet studentů čtvrťáků (pro korespondenční volbu)
        const p4Electorate = 30; 
        const p4Votes = initialData.reduce((sum, p) => sum + p.p4, 0);


        // Definované barvy pro strany
        const PARTY_COLORS = {
            'STAN': '#2196F3', // Blue
            'Piráti': '#FF9800', // Orange
            'Spolu': '#4CAF50', // Green
            'Motoristé': '#F44336', // Red
            'Koruna': '#FFEB3B', // Yellow
            'Ano': '#9C27B0', // Purple
            'Rebelové': '#E91E63', // Pink
            // Ostatní menší strany
            'SPD': '#607D8B',
            'MZH': '#795548',
            'Generace': '#00BCD4',
            'Levice': '#8BC34A',
            'SMS': '#CDDC39',
            'Přísaha': '#FFC107',
            'Voluntia': '#009688',
        };

        // --- LOGIKA PRO PŘEPOČET MANDÁTŮ (D'HONDT) ---

        /**
         * Kalkuluje mandáty pomocí D'Hondtovy metody s 5% klauzulí.
         */
        const calculateMandates = (data, totalVotes, totalMandates = 200, voteKey) => {
            const threshold = totalVotes * 0.05;
            let qualifyingParties = data.filter(p => p[voteKey] >= threshold);

            // Pokud nikdo nekvalifikuje
            if (qualifyingParties.length === 0 || totalVotes === 0) {
                return data.map(p => ({
                    ...p,
                    votes: p[voteKey],
                    percent: (totalVotes > 0) ? (p[voteKey] / totalVotes) * 100 : 0,
                    mandates: 0,
                    qualified: false,
                    color: PARTY_COLORS[p.name] || '#9CA3AF'
                }));
            }

            // Inicializace mandátů a kvocientů pro kvalifikované strany
            let mandates = {};
            let quotients = {};
            
            qualifyingParties.forEach(p => {
                mandates[p.name] = 0;
                quotients[p.name] = p[voteKey]; // Počáteční kvocient: Hlasy / 1
            });

            // Rozdělení 200 mandátů
            for (let m = 0; m < totalMandates; m++) {
                let maxQuotient = -1;
                let partyToReceiveMandate = null;

                // Najdi stranu s nejvyšším kvocientem
                for (const name in quotients) {
                    // Důležité: kontrola existence
                    if (quotients[name] > maxQuotient) {
                        maxQuotient = quotients[name];
                        partyToReceiveMandate = name;
                    }
                }

                if (partyToReceiveMandate) {
                    // Přiděl mandát
                    mandates[partyToReceiveMandate]++;

                    // Přepočítá kvocient: Hlasy / (mandáty + 1)
                    const partyVotes = qualifyingParties.find(p => p.name === partyToReceiveMandate)[voteKey];
                    quotients[partyToReceiveMandate] = partyVotes / (mandates[partyToReceiveMandate] + 1);
                } else {
                    break;
                }
            }

            // Formátování konečných výsledků
            const finalResults = data.map(p => {
                const votes = p[voteKey];
                const percent = (totalVotes > 0) ? (votes / totalVotes) * 100 : 0;
                const qualified = p[voteKey] >= threshold;
                const mandated = qualified ? (mandates[p.name] || 0) : 0;

                return {
                    ...p,
                    votes,
                    percent: percent,
                    mandates: mandated,
                    qualified: qualified,
                    color: qualified ? PARTY_COLORS[p.name] || '#374151' : '#D1D5DB' // Šedá pro nepostupující
                };
            });

            // Seřazení podle mandátů sestupně, pak podle hlasů sestupně
            finalResults.sort((a, b) => b.mandates - a.mandates || b.votes - a.votes);

            return finalResults;
        };

        // --- KOMPONENTY VIZUALIZACE ---

        const Loader = () => (
            <div className="flex justify-center items-center py-8">
                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
                <p className="ml-3 text-gray-600">Probíhá výpočet...</p>
            </div>
        );

        const PieChartView = ({ data, totalVotes }) => {
            const chartData = data
                .filter(p => p.votes > 0)
                .map(p => ({
                    name: `${p.name} (${p.percent.toFixed(1)}%)`,
                    value: p.votes,
                    color: p.color,
                }));

            return (
                <div className="flex flex-col items-center">
                    <h3 className="text-xl font-semibold mb-4 text-gray-700">Koláčový graf hlasů (Volební podíl)</h3>
                    <ResponsiveContainer width="100%" height={400}>
                        <PieChart>
                            <Pie
                                data={chartData}
                                dataKey="value"
                                nameKey="name"
                                cx="50%"
                                cy="50%"
                                outerRadius={150}
                                fill="#8884d8"
                                labelLine={false}
                                label={({ name, percent }) => `${name.split(' (')[0]} - ${(percent * 100).toFixed(1)}%`}
                            >
                                {chartData.map((entry, index) => (
                                    <Cell key={`cell-${index}`} fill={entry.color} />
                                ))}
                            </Pie>
                            <Tooltip formatter={(value, name, props) => [`${value} hlasů`, props.payload.name.split(' (')[0]]}/>
                            <Legend layout="horizontal" verticalAlign="bottom" align="center" />
                        </PieChart>
                    </ResponsiveContainer>
                    <p className="text-sm text-gray-600 mt-2">Celkem platných hlasů v tomto režimu: **{totalVotes}**.</p>
                </div>
            );
        };

        const BarChartView = ({ data }) => {
            const chartData = data.map(p => ({
                name: p.name,
                Hlasy: p.votes,
                Mandáty: p.mandates,
                color: p.color
            }));

            return (
                <div className="flex flex-col items-center">
                    <h3 className="text-xl font-semibold mb-4 text-gray-700">Sloupcový graf hlasů a mandátů</h3>
                    <ResponsiveContainer width="100%" height={400}>
                        <BarChart
                            data={chartData}
                            margin={{ top: 20, right: 30, left: 20, bottom: 5 }}
                        >
                            <CartesianGrid strokeDasharray="3 3" />
                            <XAxis dataKey="name" angle={-30} textAnchor="end" height={60} />
                            <YAxis />
                            <Tooltip />
                            <Legend />
                            <Bar dataKey="Hlasy" fill="#2563EB" name="Počet hlasů" />
                            <Bar dataKey="Mandáty" fill="#EF4444" name="Počet mandátů (200)" />
                        </BarChart>
                    </ResponsiveContainer>
                </div>
            );
        };
        
        const MandateDotPlot = ({ data }) => {
            const mandatedData = data.filter(p => p.mandates > 0);
            const totalMandates = mandatedData.reduce((sum, p) => sum + p.mandates, 0);

            if (totalMandates === 0) {
                return <p className="text-center py-8 text-lg text-red-600 font-semibold bg-red-50 rounded-lg p-4">Žádná strana nepřekročila 5% kvórum a nezískala mandáty.</p>;
            }

            return (
                <div className="flex flex-col items-center">
                    <h3 className="text-xl font-semibold mb-4 text-gray-700">Rozdělení 200 mandátů (Tečkový graf)</h3>
                    <div className="w-full max-w-4xl p-4 bg-white rounded-lg shadow-lg border border-gray-200">
                        <div className="grid grid-cols-1 gap-2 mb-4">
                            {mandatedData.map(p => (
                                <div key={p.name} className="col-span-1 flex flex-wrap items-center gap-2 mb-2 pb-2">
                                    <span className="font-bold w-full text-sm sm:w-auto sm:text-base mr-3" style={{ color: p.color }}>{p.name}:</span>
                                    <span className="text-sm text-gray-600 mr-4">{p.mandates} mandátů</span>
                                    <div className="flex flex-wrap gap-1">
                                        {Array(p.mandates).fill(0).map((_, i) => (
                                            <div
                                                key={`${p.name}-${i}`}
                                                className="w-3 h-3 rounded-full shadow-md transition-transform transform hover:scale-110"
                                                style={{ backgroundColor: p.color }}
                                                title={`${p.name}: Mandát ${i + 1}/${p.mandates}`}
                                            ></div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                    <p className="text-sm text-gray-600 mt-4">Celkem rozdělených mandátů: **{totalMandates}** z 200.</p>
                </div>
            );
        };


        const ResultsTable = ({ data, totalVotes, threshold }) => {
            return (
                <div className="overflow-x-auto">
                    <h3 className="text-xl font-semibold mb-4 text-center text-gray-700">Tabulka kompletních výsledků</h3>
                    <div className="p-4 bg-white rounded-lg shadow-lg border border-gray-200">
                        <table className="min-w-full divide-y divide-gray-200">
                            <thead className="bg-gray-50">
                                <tr>
                                    <th className="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Strana</th>
                                    <th className="px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Hlasy</th>
                                    <th className="px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Podíl (%)</th>
                                    <th className="px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">5% Klauzule</th>
                                    <th className="px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Mandáty (200)</th>
                                </tr>
                            </thead>
                            <tbody className="bg-white divide-y divide-gray-200">
                                {data.map((p, index) => (
                                    <tr key={index} className={p.qualified ? 'hover:bg-green-50' : 'hover:bg-red-50'}>
                                        <td className="px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium" style={{ color: p.color }}>
                                            {p.name}
                                        </td>
                                        <td className="px-4 md:px-6 py-4 whitespace-nowrap text-sm text-right">
                                            {p.votes}
                                        </td>
                                        <td className="px-4 md:px-6 py-4 whitespace-nowrap text-sm text-right">
                                            {p.percent.toFixed(2)} %
                                        </td>
                                        <td className="px-4 md:px-6 py-4 whitespace-nowrap text-sm text-right">
                                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.qualified ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                                                {p.qualified ? 'Postupuje' : 'Eliminována'}
                                            </span>
                                        </td>
                                        <td className="px-4 md:px-6 py-4 whitespace-nowrap text-sm font-bold text-right">
                                            {p.mandates}
                                        </td>
                                    </tr>
                                ))}
                                <tr>
                                    <td className="px-4 md:px-6 py-4 font-bold border-t-2">CELKEM</td>
                                    <td className="px-4 md:px-6 py-4 font-bold text-right border-t-2">{totalVotes}</td>
                                    <td className="px-4 md:px-6 py-4 font-bold text-right border-t-2">100.00 %</td>
                                    <td className="px-4 md:px-6 py-4 font-bold text-right border-t-2">Kvórum: {threshold.toFixed(2)}</td>
                                    <td className="px-4 md:px-6 py-4 font-bold text-right border-t-2">{data.reduce((sum, p) => sum + p.mandates, 0)}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        };

        const ExplanationModal = ({ onClose, mode, totalVotes, threshold, exampleParty }) => {
            const voteKey = mode === 'student' ? 'student' : 'total';
            const exampleVotes = exampleParty ? exampleParty[voteKey] : 'X';
            
            // Kontrola, jestli strana postupuje
            const isQualified = exampleParty.qualified;


            return (
                <div className="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4 transition-opacity duration-300">
                    <div className="bg-white rounded-xl shadow-2xl max-w-3xl w-full p-6 md:p-10 relative max-h-[90vh] overflow-y-auto transform scale-100 transition-transform duration-300">
                        <button
                            onClick={onClose}
                            className="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-3xl font-bold p-2 transition-colors"
                            aria-label="Zavřít vysvětlení"
                        >
                            &times;
                        </button>
                        <h2 className="text-2xl font-extrabold mb-4 text-blue-700">Vysvětlení přepočtu mandátů (D'Hondt)</h2>
                        <p className="text-gray-700 mb-6">
                            Systém, který se používá pro přepočet vašich hlasů na **200 mandátů** do Poslanecké sněmovny.
                        </p>

                        <h3 className="text-xl font-bold mt-4 mb-2">1. Volební kvórum (5%)</h3>
                        <p className="mb-4">
                            Pro postup do rozdělování mandátů musí strana získat alespoň **5 %** platných hlasů.
                        </p>
                        <div className="bg-blue-50 p-3 rounded-lg border border-blue-200 mb-4">
                            <p className="font-mono text-sm">Celkem platných hlasů: **{totalVotes}**</p>
                            <p className="font-mono text-sm font-bold">5% klauzule (limit): **{threshold.toFixed(2)} hlasů**</p>
                        </div>
                        
                        <h3 className="text-xl font-bold mt-6 mb-2">2. Rozdělení mandátů (D'Hondtova metoda)</h3>
                        
                        {isQualified ? (
                            <p className="mb-4">
                                Pro postupující strany se hledá **200 nejvyšších kvocientů**. Mandát získá strana, jejíž kvocient je nejvyšší.
                            </p>
                        ) : (
                             <p className="text-red-700 font-semibold mb-4">
                                Strana **{exampleParty.name}** s {exampleVotes} hlasy ({(exampleParty.percent).toFixed(2)} %) **NEPOSTUPUJE** do rozdělování mandátů, protože nepřekročila 5% kvórum. Zde je však ukázka výpočtu kvocientů pro lepší pochopení:
                            </p>
                        )}
                        

                        <div className="bg-gray-100 p-3 rounded-lg border border-gray-300 mb-4">
                            <p className="font-semibold mb-2">Vzorec:</p>
                            <p className="text-lg font-mono text-center overflow-x-auto block">
                                <span className="p-2 inline-block bg-white rounded-lg shadow-md border border-gray-300 text-lg">
                                    Kvocient = Počet hlasů strany / (Počet již získaných mandátů + 1)
                                </span>
                            </p>
                        </div>
                        <p className="mb-4 font-semibold">
                            **Příklad kvocientů pro stranu {exampleParty.name} ({exampleVotes} hlasů)**
                        </p>

                        <div className="overflow-x-auto mb-6">
                            <table className="min-w-full divide-y divide-gray-200 border border-gray-300">
                                <thead className="bg-gray-200">
                                    <tr>
                                        <th className="px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase">Mandát č.</th>
                                        <th className="px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase">Výpočet</th>
                                        <th className="px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase">Kvocient (Podíl)</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td className="px-4 py-2 whitespace-nowrap text-center font-bold text-blue-700">1.</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center text-sm">{exampleVotes} / 1</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center font-medium">**{exampleVotes}**</td>
                                    </tr>
                                    <tr>
                                        <td className="px-4 py-2 whitespace-nowrap text-center font-bold text-blue-700">2.</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center text-sm">{exampleVotes} / 2</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center font-medium">**{(exampleVotes / 2).toFixed(2)}**</td>
                                    </tr>
                                    <tr>
                                        <td className="px-4 py-2 whitespace-nowrap text-center font-bold text-blue-700">3.</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center text-sm">{exampleVotes} / 3</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center font-medium">**{(exampleVotes / 3).toFixed(2)}**</td>
                                    </tr>
                                    <tr>
                                        <td className="px-4 py-2 whitespace-nowrap text-center text-sm text-gray-400">...</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center text-sm text-gray-400">...</td>
                                        <td className="px-4 py-2 whitespace-nowrap text-center text-sm text-gray-400">...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p className="text-sm text-gray-500 italic">
                            Strana získá mandát vždy, když je její aktuální kvocient vyšší než kvocienty všech ostatních stran, které v daném kole mandát ještě nezískaly (nebo již získaly, ale jejich nový kvocient je nižší). Takto se rozdělí všech 200 mandátů.
                        </p>
                    </div>
                </div>
            );
        };


        // --- HLAVNÍ KOMPONENTA APLIKACE ---

        const App = () => {
            const [mode, setMode] = useState('student'); // 'student' nebo 'total'
            const [view, setView] = useState('pie'); // 'pie', 'bar', 'mandates', 'table'
            const [showExplanation, setShowExplanation] = useState(false);
            
            // Určení klíče pro hlasy a celkového počtu hlasů dle režimu
            const voteKey = mode === 'student' ? 'student' : 'total';
            const totalVotes = votesCast[voteKey];
            const electorate = totalElectorate[voteKey];

            // Výpočet výsledků
            const results = useMemo(() => {
                return calculateMandates(initialData, totalVotes, 200, voteKey);
            }, [mode, totalVotes]);

            // Volební účast
            const turnout = (votesCast[voteKey] / totalElectorate[voteKey]) * 100;
            const threshold = totalVotes * 0.05;
            const exampleParty = results.find(p => p.mandates > 0) || results[0]; // Použít nejúspěšnější stranu jako příklad

            const getTurnoutInfo = () => {
                if (mode === 'student') {
                    // Počet čtvrťáků, kteří volili, a celkový počet čtvrťáků
                    const p4Turnout = (p4Votes / p4Electorate) * 100;
                    
                    return (
                        <div className="text-sm">
                            <p>Celkový počet hlasujících studentů: **{votesCast.student}** / {totalElectorate.student} voličů.</p>
                            <p className="font-semibold text-blue-600 text-lg">Účast: {turnout.toFixed(2)} %</p>
                            <p className="mt-2 italic text-gray-700">
                                Z toho: **{p4Votes}** hlasů tvoří "korespondenční volba ze zahraničí" (čtvrťáci). Účast čtvrťáků: **{p4Turnout.toFixed(1)} %**
                            </p>
                        </div>
                    );
                } else {
                    return (
                        <div className="text-sm">
                            <p>Celkový počet hlasujících (studenti + učitelé): **{votesCast.total}** / {totalElectorate.total} voličů.</p>
                            <p className="font-semibold text-blue-600 text-lg">Účast: {turnout.toFixed(2)} %</p>
                        </div>
                    );
                }
            };

            const renderVisualization = () => {
                if (!results.length) return <Loader />;

                switch (view) {
                    case 'pie':
                        return <div className="flex flex-col md:flex-row gap-8">
                            <div className="w-full md:w-1/2"><PieChartView data={results} totalVotes={totalVotes} /></div>
                            <div className="w-full md:w-1/2"><MandateDotPlot data={results} /></div>
                        </div>;
                    case 'bar':
                        return <BarChartView data={results} />;
                    case 'table':
                        return <ResultsTable data={results} totalVotes={totalVotes} threshold={threshold} />;
                    case 'mandates':
                         return <MandateDotPlot data={results} />;
                    default:
                        return null;
                }
            };

            return (
                <div className="bg-white shadow-xl rounded-2xl p-4 md:p-8">
                    <h1 className="text-3xl md:text-4xl font-extrabold text-gray-800 mb-6 border-b-4 border-blue-500 pb-3">
                        Školní Volební Analýza: Simulace PS Volby
                    </h1>
                    <p className="text-lg text-gray-600 mb-6">
                        Interaktivní vizualizace volebních výsledků a přepočet hlasů na mandáty podle **D'Hondtovy metody** s 5% klauzulí (používané v ČR pro volby do Poslanecké sněmovny).
                    </p>

                    {/* Volební režimy a vysvětlení */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                        {/* Přepínání režimu */}
                        <div className="p-4 bg-gray-100 rounded-lg shadow-inner col-span-1 md:col-span-2">
                            <h2 className="text-xl font-bold mb-3 text-gray-700">1. Zvolte Režim Hlasování</h2>
                            <div className="flex flex-wrap gap-4">
                                <button
                                    onClick={() => setMode('student')}
                                    className={`px-6 py-2 rounded-full font-semibold transition duration-300 shadow-lg ${mode === 'student' ? 'bg-blue-600 text-white ring-4 ring-blue-300' : 'bg-white text-blue-600 border border-blue-600 hover:bg-blue-50'}`}
                                >
                                    Pouze studenti
                                </button>
                                <button
                                    onClick={() => setMode('total')}
                                    className={`px-6 py-2 rounded-full font-semibold transition duration-300 shadow-lg ${mode === 'total' ? 'bg-blue-600 text-white ring-4 ring-blue-300' : 'bg-white text-blue-600 border border-blue-600 hover:bg-blue-50'}`}
                                >
                                    Studenti + Učitelé (Celkem)
                                </button>
                                <button
                                    onClick={() => setShowExplanation(true)}
                                    className="px-6 py-2 rounded-full font-semibold transition duration-200 bg-purple-500 text-white hover:bg-purple-600 shadow-md flex items-center"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2.936 3.447L9.4 14H8.5v-1.5a.5.5 0 011 0V13h1.5a.5.5 0 01.5.5v.5h-2a1 1 0 00-1 1v1h4a1 1 0 001-1V10a4 4 0 00-4-4v-1zM9 14.5a.5.5 0 011 0v.5H9v-.5z" clipRule="evenodd" /></svg>
                                    Jak funguje přepočet?
                                </button>
                            </div>
                        </div>

                        {/* Volební účast */}
                        <div className="p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-lg shadow-inner">
                             <h2 className="text-xl font-bold mb-2 text-gray-700">Volební účast</h2>
                             {getTurnoutInfo()}
                        </div>
                    </div>

                    {/* Přepínání zobrazení */}
                    <div className="mb-8 border-t border-gray-300 pt-4">
                        <h2 className="text-xl font-bold mb-3 text-gray-700">2. Zvolte Zobrazení Výsledků</h2>
                        <div className="flex flex-wrap gap-3">
                            <button
                                onClick={() => setView('pie')}
                                className={`px-4 py-2 rounded-lg font-medium transition duration-200 shadow-md ${view === 'pie' ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                            >
                                Koláčový graf (Hlasy) & Tečky (Mandáty)
                            </button>
                            <button
                                onClick={() => setView('bar')}
                                className={`px-4 py-2 rounded-lg font-medium transition duration-200 shadow-md ${view === 'bar' ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                            >
                                Sloupcový graf (Hlasy vs. Mandáty)
                            </button>
                            <button
                                onClick={() => setView('table')}
                                className={`px-4 py-2 rounded-lg font-medium transition duration-200 shadow-md ${view === 'table' ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                            >
                                Podrobná Tabulka
                            </button>
                        </div>
                    </div>

                    {/* Vykreslení vizualizace */}
                    <div className="min-h-[500px] border-t border-gray-300 pt-8">
                        {renderVisualization()}
                    </div>

                    {/* Modal pro vysvětlení */}
                    {showExplanation && (
                        <ExplanationModal
                            onClose={() => setShowExplanation(false)}
                            mode={mode}
                            totalVotes={totalVotes}
                            threshold={threshold}
                            exampleParty={exampleParty}
                        />
                    )}
                </div>
            );
        };

        // Renderování aplikace do DOM
        const rootElement = document.getElementById('root');
        ReactDOM.createRoot(rootElement).render(<App />);
    </script>
</body>
</html>
